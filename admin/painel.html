<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Painel Administrativo</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    input, button { margin: 5px; padding: 8px; }
    #produtos-lista { margin-top: 20px; }
    .produto { border: 1px solid #ccc; padding: 10px; margin-bottom: 10px; }
  </style>
</head>
<body>
  <h1>Gerenciar Produtos</h1>

  <form id="form-produto" enctype="multipart/form-data">
  <input type="text" id="nome" name="nome" placeholder="Nome do produto" required>
  <input type="text" id="preco" name="preco" placeholder="Preço" required>

  <select id="categoria" name="categoria" required>
    <option value="">Escolha uma categoria</option>
    <option value="pães">Pães</option>
    <option value="doces">Doces</option>
    <option value="salgados">Salgados</option>
  </select>

  <div>
    <label><input type="radio" name="tipo" value="unidade" checked> Unidade</label>
    <label><input type="radio" name="tipo" value="peso"> Peso</label>
  </div>

  <input type="file" id="imagens" name="imagens" accept="image/*" multiple required>
<small>Máximo 5 imagens</small>

  <input type="hidden" id="produtoId">
  <button type="submit">Salvar Produto</button>
</form>


  <h2>Produtos cadastrados</h2>
  <div id="produtos-lista"></div>

  <script>
    async function carregarProdutos() {
      const res = await fetch('/produtos');
      const produtos = await res.json();
      const lista = document.getElementById('produtos-lista');
      lista.innerHTML = '';

      produtos.forEach(prod => {
        const div = document.createElement('div');
        div.className = 'produto';
        div.innerHTML = `
          <strong>${prod.nome}</strong><br>
          Preço: R$ ${prod.preco}<br>
          <img src="${prod.imagem}" width="100">
        `;
        lista.appendChild(div);
      });
    }

  document.getElementById('form-produto').addEventListener('submit', async (e) => {
    e.preventDefault();

    const form = document.getElementById('form-produto');
    const formData = new FormData(form); // ✅ importante para incluir arquivos

    const res = await fetch('/produtos', {
      method: 'POST',
      body: formData // ✅ envia texto e imagens
    });

    if (res.ok) {
      alert('Produto adicionado com sucesso!');
      form.reset();
    } else {
      alert('Erro ao adicionar produto');
    }
  });



  </script>
</body>
</html>
